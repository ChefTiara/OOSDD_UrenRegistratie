<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Hourregistration.App.ViewModels"
             xmlns:m="clr-namespace:Hourregistration.Core.Models;assembly=Hourregistration.Core"
             x:Class="Hourregistration.App.Views.EmployeeHoursOverviewView"
             x:DataType="vm:EmployeeHoursOverviewViewModel"
             Title="Urenoverzicht medewerkers"
             BackgroundColor="{AppThemeBinding Light={StaticResource Tertiary}, Dark={StaticResource PrimaryDark}}">           

    <VerticalStackLayout Padding="12"
                         Spacing="14"
                         HorizontalOptions="FillAndExpand">

        <!-- TITLE + SEARCH + FILTERS in one horizontal row -->
        <Grid ColumnDefinitions="Auto,*,Auto,Auto"
          ColumnSpacing="12"
          HorizontalOptions="FillAndExpand">

            <!-- TITLE -->
            <Label Text="Urenoverzicht:"
           FontSize="22"
           FontAttributes="Bold"
           VerticalOptions="Center"
           HorizontalOptions="Start"/>

            <!-- SEARCHBAR -->
            <SearchBar Grid.Column="1"
               Placeholder="Zoeken op naam..."
               Text="{Binding SearchText}"
               HorizontalOptions="FillAndExpand"
               VerticalOptions="Center"/>

            <!-- FILTER PICKER (Functie) -->
            <Picker Grid.Column="2"
            WidthRequest="130"
            ItemsSource="{Binding FunctieOptions}"
            SelectedItem="{Binding SelectedFunctie}"
            Title="Functie"
            VerticalOptions="Center"
            />
        </Grid>

        <!-- HEADER ROW -->
        <Grid HorizontalOptions="FillAndExpand"
              ColumnSpacing="12"
              RowDefinitions="Auto"
              ColumnDefinitions="2*,1.2*,1.2*,1.2*,0.8*,0.4*">

            <Label Text="Naam" FontAttributes="Bold"/>
            <Label Grid.Column="1" Text="Functie" FontAttributes="Bold"/>
            <Label Grid.Column="2" Text="Datum" FontAttributes="Bold"/>
            <Label Grid.Column="3" Text="Ingepland" FontAttributes="Bold"/>
            <Label Grid.Column="4" Text="Uren" FontAttributes="Bold"/>
            <Label Grid.Column="5"/>
        </Grid>

        <!-- TABLE BODY -->
        <CollectionView ItemsSource="{Binding EmployeeHours}"
                        SelectionMode="None"
                        HorizontalOptions="FillAndExpand"
                        VerticalOptions="FillAndExpand">

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="m:DeclaredHoursEmployee">

                    <!-- ROW GRID -->
                    <Grid ColumnSpacing="12"
                          Padding="4"
                          HorizontalOptions="FillAndExpand"
                          ColumnDefinitions="2*,1.2*,1.2*,1.2*,0.8*,0.4*">

                        <Label Text="{Binding FullName}"
                               VerticalOptions="Center"
                               LineBreakMode="TailTruncation"
                               MaxLines="1"/>

                        <Label Grid.Column="1"
                               Text="{Binding Role}"
                               VerticalOptions="Center"/>

                        <Label Grid.Column="2"
                               Text="{Binding Date, StringFormat='{0:dd-MM-yyyy}'}"
                               VerticalOptions="Center"/>

                        <Label Grid.Column="3"
                               Text="{Binding PlannedHours}"
                               VerticalOptions="Center"
                               MaxLines="1"/>

                        <Label Grid.Column="4"
                               Text="{Binding WorkedHours, StringFormat='{0}u'}"
                               VerticalOptions="Center"
                               FontAttributes="Bold"/>

                        <Label Grid.Column="5"
                               Text="â€º"
                               FontSize="20"
                               VerticalOptions="Center"
                               HorizontalOptions="Center"/>
                    </Grid>

                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </VerticalStackLayout>

</ContentPage>
