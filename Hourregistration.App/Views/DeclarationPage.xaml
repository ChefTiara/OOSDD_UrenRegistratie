<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Hourregistration.App.Views.DeclarationPage"
             x:Name="declarationPage"
             Title="Urenregistratie concept">

    <VerticalStackLayout Padding="20" Spacing="20">

        <!-- Title -->
        <Label Text="Declaratie concept"
               FontSize="22"
               FontAttributes="Bold" />

        <!-- Big box -->
        <Border Stroke="Black"
                StrokeThickness="1"
                BackgroundColor="{AppThemeBinding 
                    Light={StaticResource Outline}, 
                    Dark={StaticResource OutlineDark}}"
                Padding="15"
                HeightRequest="400">

            <ScrollView>
                <VerticalStackLayout Spacing="15">

                    <!-- Dynamic rows -->
                    <VerticalStackLayout BindableLayout.ItemsSource="{Binding Rows}"
                                         x:Name="InputContainer"
                                         Spacing="10">

                        <BindableLayout.ItemTemplate>
                            <DataTemplate>
                                <!-- Grid-based declaration row -->
                                <Grid ColumnSpacing="10"
                                      Padding="5"
                                      HorizontalOptions="Fill"
                                      ColumnDefinitions="120, 80, 120, *, 40">

                                    <!-- Date -->
                                    <VerticalStackLayout Grid.Column="0">
                                        <Label Text="Datum" FontSize="12"/>
                                        <DatePicker Date="{Binding Date}"
                                                    Format="dd-MM-yyyy"
                                                    HeightRequest="40"/>
                                    </VerticalStackLayout>

                                    <!-- Hours -->
                                    <VerticalStackLayout Grid.Column="1">
                                        <Label Text="Aantal uren" FontSize="12"/>
                                        <Entry Text="{Binding WorkedHours}"
                                               Keyboard="Numeric"
                                               Placeholder="0"
                                               HeightRequest="40"/>
                                    </VerticalStackLayout>

                                    <!-- Reason -->
                                    <VerticalStackLayout Grid.Column="2">
                                        <Label Text="Reden" FontSize="12"/>
                                        <Picker SelectedItem="{Binding Reason}"
                                                BackgroundColor="#F2F2F2"
                                                TextColor="Black"
                                                HeightRequest="40">
                                            <Picker.Items>
                                                <x:String>Werk</x:String>
                                                <x:String>Verlof</x:String>
                                                <x:String>Ziek</x:String>
                                            </Picker.Items>
                                        </Picker>
                                    </VerticalStackLayout>

                                    <!-- Description -->
                                    <VerticalStackLayout Grid.Column="3">
                                        <Label Text="Beschrijving" FontSize="12"/>
                                        <Entry Text="{Binding Description}"
                                               BackgroundColor="#F2F2F2"
                                               TextColor="Black"
                                               Placeholder="Omschrijving..."
                                               HeightRequest="40"/>
                                    </VerticalStackLayout>

                                    <!-- Delete Row Button -->
                                    <Button Grid.Column="4"
                                            Text="x"
                                            FontAttributes="Bold"
                                            CornerRadius="4"
                                            Command="{Binding Source={x:Reference declarationPage}, Path=DeleteRowCommand}"
                                            CommandParameter="{Binding}" />
                                </Grid>
                            </DataTemplate>
                        </BindableLayout.ItemTemplate>
                    </VerticalStackLayout>

                    <!-- Add (+) button -->
                    <Button Text="+"
                            FontSize="18"
                            WidthRequest="40"
                            HeightRequest="40"
                            HorizontalOptions="Center"
                            Clicked="OnAddRowClicked"/>
                </VerticalStackLayout>
            </ScrollView>
        </Border>

        <!-- Bottom buttons -->
        <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">

            <Button Grid.Column="0"
                    Text="Declaratie verwijderen"
                    Style="{StaticResource ButtonMid}"
                    CornerRadius="6"
                    Clicked="OnVerwijderenClicked"/>

            <Button Grid.Column="1"
                    Text="Opslaan als concept"
                    Style="{StaticResource ButtonLight}"
                    CornerRadius="6"
                    Clicked="OnOpslaanAlsConceptClicked"/>

            <Button Grid.Column="2"
                    Text="Declaratie indienen"
                    Style="{StaticResource ButtonDark}"
                    CornerRadius="6"
                    Clicked="OnIndienenClicked"/>
        </Grid>

        <!-- Feedback -->
        <Label x:Name="FeedbackLabel"
               FontSize="14"
               TextColor="Red"
               HorizontalOptions="Center"/>

    </VerticalStackLayout>
</ContentPage>